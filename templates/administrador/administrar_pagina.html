{% extends 'base.html' %}

{% block contenido %}
<form method="POST" style="max-width:600px;margin:0 auto;padding:20px;border:1px solid #ccc;border-radius:8px;background:#f9f9f9">

  <h2 style="margin-bottom:20px;color:#333">Configuración del Colegio</h2>

  <div style="margin-bottom:15px">
    <label for="nombre_colegio" style="display:block;font-weight:bold;margin-bottom:5px">Nombre del Colegio:</label>
    <input type="text" name="nombre_colegio" id="nombre_colegio"
           value="{{ nombre_colegio }}"
           maxlength="50"
           pattern="^[^$&|{}<>;'\"]+$"
           title="Evita caracteres especiales como $, &, |, {}, <>, ;, ', \""
           required
           style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>

  <div style="margin-bottom:25px">
    <label for="lema_colegio" style="display:block;font-weight:bold;margin-bottom:5px">Lema del Colegio:</label>
    <input type="text" name="lema_colegio" id="lema_colegio"
           value="{{ lema_colegio }}"
           maxlength="100"
           pattern="^[^$&|{}<>;'\"]+$"
           title="Evita caracteres especiales como $, &, |, {}, <>, ;, ', \""
           required
           style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>

  <div style="margin-bottom:25px">
    <label for="nombre_director" style="display:block;font-weight:bold;margin-bottom:5px">Nombre del Director:</label>
    <input type="text" name="nombre_director" id="nombre_director"
           value="{{ nombre_director }}"
           maxlength="80"
           pattern="^[^$&|{}<>;'\"]+$"
           title="Evita caracteres especiales como $, &, |, {}, <>, ;, ', \""
           required
           style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>
  
  <h3 style="margin-bottom:15px;color:#444">Redes Sociales</h3>

  {% for red in redes_sociales %}
    {% for key in red.keys() %}
      <div style="margin-bottom:15px">
        <label for="{{ key }}" style="display:block;font-weight:bold;margin-bottom:5px">
          {{ key | capitalize }}:
        </label>
        <input type="url" name="{{ key }}" id="{{ key }}"
               value="{{ red[key] }}"
               maxlength="100"
               pattern="^(https?:\/\/)?[^$&|{}<>;'\"]+$"
               title="Evita caracteres especiales como $, &, |, {}, <>, ;, ', \""
               placeholder="https://{{ key }}.com/..."
               style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
      </div>
    {% endfor %}
  {% endfor %}


  <div style="margin-bottom:15px">
    <label for="correo_colegio" style="display:block;font-weight:bold;margin-bottom:5px">Correo del Colegio:</label>
    <input type="email" name="correo_colegio" id="correo_colegio"
           value="{{ correo_colegio }}"
           maxlength="100"
           pattern="^[^$&|{}<>;'\"]+$"
           title="Evita caracteres especiales como $, &, |, {}, <>, ;, ', \""
           style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>

  <div style="margin-bottom:15px">
    <label for="direccion_colegio" style="display:block;font-weight:bold;margin-bottom:5px">Dirección del Colegio:</label>
    <input type="text" name="direccion_colegio" id="direccion_colegio"
           value="{{ direccion_colegio }}"
           maxlength="150"
           pattern="^[^$&|{}<>;'\"]+$"
           title="Evita caracteres especiales como $, &, |, {}, <>, ;, ', \""
           style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>

  <div style="margin-bottom:15px">
    <label for="telefono_colegio" style="display:block;font-weight:bold;margin-bottom:5px">Teléfono del Colegio:</label>
    <input type="tel" name="telefono_colegio" id="telefono_colegio"
           value="{{ telefono_colegio }}"
           maxlength="20"
           pattern="^[0-9+\s()-]+$"
           title="Solo números, espacios, paréntesis y signos + permitidos"
           style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>

  <div style="margin-bottom:15px">
    <label for="calendario_colegio" style="display:block;font-weight:bold;margin-bottom:5px">
      Calendario del Colegio:
    </label>
    <input type="url" name="calendario_colegio" id="calendario_colegio"
          value="{{ calendario_colegio }}"
          maxlength="500"
          pattern="^(https?:\/\/)[^\s<>\"']+$"
          title="Ingrese una URL válida. Se permiten parámetros como ?, =, %, &, pero evite espacios o caracteres inseguros (<, >, ', \")."
          placeholder="https://calendar.google.com/calendar/embed?..."
          style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px">
  </div>

  <div style="text-align:right;margin-top:30px">
    <button type="submit" name="accion" value="modificar_base" style="padding:10px 20px;background:#007bff;color:white;border:none;border-radius:4px;cursor:pointer">
      Guardar Cambios
    </button>
  </div>

</form>

<hr>

<div id="nuevo_ano" hidden>

  <form method="POST" enctype="multipart/form-data">
    <h3>Sube la Base De Datos de Estudiantes. EXEL</h3>
    <input type="file" name="exel">
    <button type="submit" name="accion" value="nuevo_ano">Subir Exel de Estudiantes</button>
  </form>

</div>
<button onclick="mostrar_ano()">Nuevo Año Escolar</button>

<!-- Disclaimer -->
<div id="disclaimer" style="display:none;position:fixed;bottom:20px;right:20px;background:#fff3cd;color:#856404;border:1px solid #ffeeba;padding:15px 20px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.2);z-index:1000;font-size:14px">
  <strong>Advertencia: Sección sensible</strong><br>
  Todo cambio realizado en esta página requiere un extremo cuidado. Contacte con el administrador para efectuar los cambios.
</div>

<script>

  function mostrar_ano() {
    document.getElementById("nuevo_ano").hidden = false
  }

  window.addEventListener('load', function() {
    const aviso = document.getElementById('disclaimer');
    aviso.style.display = 'block';
    setTimeout(() => {
      aviso.style.opacity = '0';
      setTimeout(() => aviso.remove(), 1000);
    }, 10000); // visible por 10 segundos
  });
</script>
{% endblock %}
